<template>
  <div class="side-container">
    <div class="side-nav">
      <div class="side-box">
        <!-- 客服 -->
        <div
          class="box-icon"
          @mouseover="toFonts($event, '客服')"
          @mouseleave="toSvg($event)"
          @click="displayService = true"
        >
          <svg
            t="1602598872149"
            class="icon"
            viewBox="0 0 1024 1024"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            p-id="5128"
            width="20"
            height="20"
          >
            <path
              d="M510.097674 189.494819c-134.373407 0-243.281839 106.623389-243.281839 238.182704 0 131.541919 108.908432 238.179634 243.281839 238.179634 134.3775 0 243.285932-106.636692 243.285932-238.179634C753.383606 296.117185 644.475174 189.494819 510.097674 189.494819L510.097674 189.494819zM510.097674 189.494819"
              p-id="5129"
              fill="#ffffff"
            />
            <path
              d="M229.17761 519.102768 229.17761 299.209616c-3.079128 0-6.132674 0.125867-9.148357 0.366344C269.882684 191.349049 380.918569 115.974361 510.135536 115.974361c129.21185 0 240.253876 75.374688 290.103214 183.600575-3.016707-0.240477-6.066159-0.366344-9.148357-0.366344l0 219.894176c62.052265 0 112.390743-49.231261 112.390743-109.941971 0-41.235147-23.219841-77.163427-57.552787-95.982028-48.314379-136.089491-180.214455-233.837746-335.792812-233.837746-155.577335 0-287.469224 97.739045-335.788719 233.824443-34.344203 18.815531-57.555857 54.750975-57.555857 95.990215C116.79096 469.871507 167.090553 519.102768 229.17761 519.102768L229.17761 519.102768zM229.17761 519.102768"
              p-id="5130"
              fill="#ffffff"
            />
            <path
              d="M752.869906 645.160789c-63.570851 58.08593-148.919704 93.65196-242.772232 93.65196-93.676519 0-178.881087-35.435047-242.415099-93.327572C153.974837 702.767811 79.32465 804.722878 79.32465 943.226349l864.503403 0C943.827029 804.465005 867.780029 702.385095 752.869906 645.160789L752.869906 645.160789zM752.869906 645.160789"
              p-id="5131"
              fill="#ffffff"
            />
          </svg>
        </div>
      </div>
      <!-- 微信账号 -->
      <div class="side-box">
        <div
          class="box-icon"
          @mouseover="toFonts($event, '微信')"
          @mouseleave="toSvg($event)"
        >
          <svg
            t="1602598843971"
            class="icon"
            viewBox="0 0 1024 1024"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            p-id="4227"
            width="20"
            height="20"
          >
            <path
              d="M693.12 347.264c11.776 0 23.36 0.896 35.008 2.176-31.36-146.048-187.456-254.528-365.696-254.528C163.2 94.912 0 230.656 0 403.136c0 99.52 54.272 181.248 145.024 244.736L108.8 756.864l126.72-63.488c45.312 8.896 81.664 18.112 126.912 18.112 11.392 0 22.656-0.512 33.792-1.344-7.04-24.256-11.2-49.6-11.2-76.032C385.088 475.776 521.024 347.264 693.12 347.264zM498.304 249.024c27.392 0 45.376 17.984 45.376 45.248 0 27.136-17.984 45.312-45.376 45.312-27.072 0-54.336-18.176-54.336-45.312C443.968 266.944 471.168 249.024 498.304 249.024zM244.672 339.584c-27.2 0-54.592-18.176-54.592-45.312 0-27.264 27.392-45.248 54.592-45.248S289.92 266.944 289.92 294.272C289.92 321.408 271.872 339.584 244.672 339.584zM1024 629.76c0-144.896-145.024-262.976-307.904-262.976-172.48 0-308.224 118.144-308.224 262.976 0 145.28 135.808 262.976 308.224 262.976 36.096 0 72.512-9.024 108.736-18.112l99.392 54.528-27.264-90.624C969.728 783.872 1024 711.488 1024 629.76zM616.128 584.384c-17.984 0-36.224-17.92-36.224-36.224 0-18.048 18.24-36.224 36.224-36.224 27.52 0 45.376 18.176 45.376 36.224C661.504 566.464 643.648 584.384 616.128 584.384zM815.488 584.384c-17.856 0-36.032-17.92-36.032-36.224 0-18.048 18.112-36.224 36.032-36.224 27.264 0 45.376 18.176 45.376 36.224C860.864 566.464 842.752 584.384 815.488 584.384z"
              p-id="4228"
              fill="#ffffff"
            />
          </svg>
        </div>
      </div>
      <!-- 推荐码 -->
      <div class="side-box">
        <div
          class="box-icon"
          @mouseover="toFonts($event, '推荐码')"
          @mouseleave="toSvg($event)"
          @click="recommendModal = true"
        >
          <svg
            t="1618231552182"
            class="icon"
            viewBox="0 0 1024 1024"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            p-id="2583"
            width="30"
            height="30"
          >
            <path
              d="M512.922 41.77l-66.466 92.314-96.007-60.927-24.001 112.623-112.623-20.31 20.31 112.623-112.623 24.001 60.927 96.007-92.314 66.466 92.314 64.62-60.927 96.007 112.623 25.849-20.31 110.777 112.623-18.463 24.001 110.777 96.007-60.927 66.466 92.314 64.62-92.314 96.007 60.927 25.849-110.777 110.777 18.463-18.463-110.777 110.777-25.849-60.927-96.007 92.314-64.62-92.314-66.466 60.927-96.007-110.777-24.001 18.463-112.623-110.777 20.31-25.849-112.623-96.007 60.927-64.62-92.314zM402.147 462.724v240.016h-36.925v-190.166c-22.155 25.847-46.158 49.85-70.159 70.159-9.233-12.924-16.615-24.001-22.155-31.387 48.003-40.618 92.314-90.468 127.393-149.548h-112.623v-35.079h131.086c5.539-7.386 9.233-14.771 12.924-22.155h36.925c-3.692 7.386-7.386 14.771-11.078 22.155h284.327v35.079h-300.944c-12.924 20.309-25.847 42.464-38.772 60.927zM749.247 580.884h-127.393v64.62c0 38.772-18.463 57.235-53.543 57.235-20.309 0-48.003 0-84.929 0-1.847-12.924-3.692-25.849-5.539-40.618 29.54 3.692 57.235 3.692 81.236 3.692 16.617 0 25.849-7.386 25.849-25.849v-59.081h-145.856v-33.233h145.856v-24.001l70.159-46.158h-190.167v-33.233h251.093v33.233l-94.161 59.081v11.078h127.393v33.233zM749.247 307.636h-127.393v35.078h-36.925v-35.078h-134.779v31.387h-36.925v-31.387h-127.393v-33.233h127.393v-42.464h36.925v42.464h134.779v-44.311h36.925v44.311h127.393v33.233z"
              p-id="2584"
              fill="#ffffff"
            ></path>
          </svg>
        </div>
      </div>

      <!-- 二维码分享 -->
      <Poptip placement="right" v-model="shareModal" trigger="hover" >
        <!--分享二维码 -->
        <div class="side-box">
          <div
            class="box-icon"
            @mouseover="toFonts($event, '分享')"
            @mouseleave="toSvg($event)"
            @click="openShare"
          >
            <svg
              t="1618231735199"
              class="icon"
              viewBox="0 0 1024 1024"
              version="1.1"
              xmlns="http://www.w3.org/2000/svg"
              p-id="4332"
              width="25"
              height="25"
            >
              <path
                d="M512 0C229.23 0 0 229.23 0 512s229.23 512 512 512 512-229.23 512-512S794.77 0 512 0z m150.888 822.576c-56.452 0-102.807-43.195-107.838-98.335l-175.252-71.917c-16.481 10.135-35.881 15.985-56.648 15.985-59.812 0-108.299-48.487-108.299-108.299s48.487-108.299 108.299-108.299c11.68 0 22.925 1.857 33.464 5.278l128.185-128.185c-4.694-12.125-7.274-25.303-7.274-39.084 0-59.812 48.487-108.299 108.299-108.299s108.299 48.487 108.299 108.299c0 59.812-48.487 108.299-108.299 108.299-19.668 0-38.11-5.244-54.008-14.408L414.149 501.277c10.943 16.92 17.299 37.083 17.299 58.733 0 11.697-1.862 22.958-5.293 33.51l146.883 60.275c19.456-28.847 52.437-47.818 89.849-47.818 59.812 0 108.299 48.487 108.299 108.299s-48.486 108.3-108.298 108.3z"
                fill="#ffffff"
                p-id="4333"
              ></path>
            </svg>
          </div>
        </div>
        <div slot="content" class="share-wrap">
          <img src="../../../assets/images/QRCode.png" alt="">
            <p>右键复制二维码图片</p>
            <Button type="primary" @click="copyShare">一键复制分享内容</Button>
        </div>
      </Poptip>
      <!-- 置顶按钮 -->
      <div class="side-box">
        <div
          class="box-icon"
          @click="toTop"
          @mouseover="toFonts($event, '置顶')"
          @mouseleave="toSvg($event)"
        >
          <svg
            t="1602598897107"
            class="icon"
            viewBox="0 0 1024 1024"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            p-id="5963"
            width="20"
            height="20"
          >
            <path
              d="M1024 0v102.4H0V0h1024zM512 153.6l512 496.7936h-297.984L727.1936 1024h-429.056v-373.6064H0L512 153.6z"
              p-id="5964"
              fill="#ffffff"
            />
          </svg>
        </div>
      </div>
    </div>
    <!-- 客服面板 -->
    <div class="side-details">
      <div class="side-service">
        <p>联系电话</p>
        <p>17666665234</p>
        <p>———————</p>
        <p>投稿 合著 独著</p>
        <p>编委 论文 专著</p>
        <p>专利申请&转让</p>
      </div>
      <div class="side-wechat">
        <div class="side-QRCode">
          <img src="../../../assets/images/wechat.jpg" class="wechat" />
        </div>
      </div>
    </div>
    <!-- 推荐面板 -->
    <Modal
      class="recommend-wrap"
      mask
      :closable="false"
      title="获取推荐码"
      v-model="recommendModal"
    >
      <div class="recommend-content">
        <div class="tip">推荐码可以分享给别人，供他人注册时使用</div>
        <div class="code-row">
          <Button @click="getCode()" :disabled="isBan" type="primary" ghost>
            <span v-show="!isBan">获取推荐码</span>
            <span v-show="isBan">({{ time }}s)</span>
          </Button>
          <div class="code">推荐码：{{ recommendCode }}</div>
        </div>
      </div>
    </Modal>
  </div>
</template>
<script>
export default {
  name: "SideNav",
  data() {
    return {
      svg1:
        '<svg data-v-d2fa3dc4="" t="1602598872149" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5128" width="20" height="20" class="icon"><path data-v-d2fa3dc4="" d="M510.097674 189.494819c-134.373407 0-243.281839 106.623389-243.281839 238.182704 0 131.541919 108.908432 238.179634 243.281839 238.179634 134.3775 0 243.285932-106.636692 243.285932-238.179634C753.383606 296.117185 644.475174 189.494819 510.097674 189.494819L510.097674 189.494819zM510.097674 189.494819" p-id="5129" fill="#ffffff"></path> <path data-v-d2fa3dc4="" d="M229.17761 519.102768 229.17761 299.209616c-3.079128 0-6.132674 0.125867-9.148357 0.366344C269.882684 191.349049 380.918569 115.974361 510.135536 115.974361c129.21185 0 240.253876 75.374688 290.103214 183.600575-3.016707-0.240477-6.066159-0.366344-9.148357-0.366344l0 219.894176c62.052265 0 112.390743-49.231261 112.390743-109.941971 0-41.235147-23.219841-77.163427-57.552787-95.982028-48.314379-136.089491-180.214455-233.837746-335.792812-233.837746-155.577335 0-287.469224 97.739045-335.788719 233.824443-34.344203 18.815531-57.555857 54.750975-57.555857 95.990215C116.79096 469.871507 167.090553 519.102768 229.17761 519.102768L229.17761 519.102768zM229.17761 519.102768" p-id="5130" fill="#ffffff"></path> <path data-v-d2fa3dc4="" d="M752.869906 645.160789c-63.570851 58.08593-148.919704 93.65196-242.772232 93.65196-93.676519 0-178.881087-35.435047-242.415099-93.327572C153.974837 702.767811 79.32465 804.722878 79.32465 943.226349l864.503403 0C943.827029 804.465005 867.780029 702.385095 752.869906 645.160789L752.869906 645.160789zM752.869906 645.160789" p-id="5131" fill="#ffffff"></path></svg>',
      svg2:
        '<svg data-v-d2fa3dc4="" t="1602598843971" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4227" width="20" height="20" class="icon"><path data-v-d2fa3dc4="" d="M693.12 347.264c11.776 0 23.36 0.896 35.008 2.176-31.36-146.048-187.456-254.528-365.696-254.528C163.2 94.912 0 230.656 0 403.136c0 99.52 54.272 181.248 145.024 244.736L108.8 756.864l126.72-63.488c45.312 8.896 81.664 18.112 126.912 18.112 11.392 0 22.656-0.512 33.792-1.344-7.04-24.256-11.2-49.6-11.2-76.032C385.088 475.776 521.024 347.264 693.12 347.264zM498.304 249.024c27.392 0 45.376 17.984 45.376 45.248 0 27.136-17.984 45.312-45.376 45.312-27.072 0-54.336-18.176-54.336-45.312C443.968 266.944 471.168 249.024 498.304 249.024zM244.672 339.584c-27.2 0-54.592-18.176-54.592-45.312 0-27.264 27.392-45.248 54.592-45.248S289.92 266.944 289.92 294.272C289.92 321.408 271.872 339.584 244.672 339.584zM1024 629.76c0-144.896-145.024-262.976-307.904-262.976-172.48 0-308.224 118.144-308.224 262.976 0 145.28 135.808 262.976 308.224 262.976 36.096 0 72.512-9.024 108.736-18.112l99.392 54.528-27.264-90.624C969.728 783.872 1024 711.488 1024 629.76zM616.128 584.384c-17.984 0-36.224-17.92-36.224-36.224 0-18.048 18.24-36.224 36.224-36.224 27.52 0 45.376 18.176 45.376 36.224C661.504 566.464 643.648 584.384 616.128 584.384zM815.488 584.384c-17.856 0-36.032-17.92-36.032-36.224 0-18.048 18.112-36.224 36.032-36.224 27.264 0 45.376 18.176 45.376 36.224C860.864 566.464 842.752 584.384 815.488 584.384z" p-id="4228" fill="#ffffff"></path></svg>',
      svg3:
        '<svg data-v-d2fa3dc4="" t="1602598897107" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5963" width="20" height="20" class="icon"><path data-v-d2fa3dc4="" d="M1024 0v102.4H0V0h1024zM512 153.6l512 496.7936h-297.984L727.1936 1024h-429.056v-373.6064H0L512 153.6z" p-id="5964" fill="#ffffff"></path></svg>',
      svg4:
        '<svg t="1618231552182" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2583" width="30" height="30"><path d="M512.922 41.77l-66.466 92.314-96.007-60.927-24.001 112.623-112.623-20.31 20.31 112.623-112.623 24.001 60.927 96.007-92.314 66.466 92.314 64.62-60.927 96.007 112.623 25.849-20.31 110.777 112.623-18.463 24.001 110.777 96.007-60.927 66.466 92.314 64.62-92.314 96.007 60.927 25.849-110.777 110.777 18.463-18.463-110.777 110.777-25.849-60.927-96.007 92.314-64.62-92.314-66.466 60.927-96.007-110.777-24.001 18.463-112.623-110.777 20.31-25.849-112.623-96.007 60.927-64.62-92.314zM402.147 462.724v240.016h-36.925v-190.166c-22.155 25.847-46.158 49.85-70.159 70.159-9.233-12.924-16.615-24.001-22.155-31.387 48.003-40.618 92.314-90.468 127.393-149.548h-112.623v-35.079h131.086c5.539-7.386 9.233-14.771 12.924-22.155h36.925c-3.692 7.386-7.386 14.771-11.078 22.155h284.327v35.079h-300.944c-12.924 20.309-25.847 42.464-38.772 60.927zM749.247 580.884h-127.393v64.62c0 38.772-18.463 57.235-53.543 57.235-20.309 0-48.003 0-84.929 0-1.847-12.924-3.692-25.849-5.539-40.618 29.54 3.692 57.235 3.692 81.236 3.692 16.617 0 25.849-7.386 25.849-25.849v-59.081h-145.856v-33.233h145.856v-24.001l70.159-46.158h-190.167v-33.233h251.093v33.233l-94.161 59.081v11.078h127.393v33.233zM749.247 307.636h-127.393v35.078h-36.925v-35.078h-134.779v31.387h-36.925v-31.387h-127.393v-33.233h127.393v-42.464h36.925v42.464h134.779v-44.311h36.925v44.311h127.393v33.233z" p-id="2584" fill="#ffffff"></path></svg>',
      svg5:
        '<svg t="1618231735199" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4332" width="25" height="25"><path d="M512 0C229.23 0 0 229.23 0 512s229.23 512 512 512 512-229.23 512-512S794.77 0 512 0z m150.888 822.576c-56.452 0-102.807-43.195-107.838-98.335l-175.252-71.917c-16.481 10.135-35.881 15.985-56.648 15.985-59.812 0-108.299-48.487-108.299-108.299s48.487-108.299 108.299-108.299c11.68 0 22.925 1.857 33.464 5.278l128.185-128.185c-4.694-12.125-7.274-25.303-7.274-39.084 0-59.812 48.487-108.299 108.299-108.299s108.299 48.487 108.299 108.299c0 59.812-48.487 108.299-108.299 108.299-19.668 0-38.11-5.244-54.008-14.408L414.149 501.277c10.943 16.92 17.299 37.083 17.299 58.733 0 11.697-1.862 22.958-5.293 33.51l146.883 60.275c19.456-28.847 52.437-47.818 89.849-47.818 59.812 0 108.299 48.487 108.299 108.299s-48.486 108.3-108.298 108.3z" fill="#ffffff" p-id="4333"></path></svg>',
      recommendModal: false, //控制推荐面板的显示
      shareModal: false, // 控制分享面板的显示
      recommendCode: "", //推荐码
      isBan: false, //是否禁止发送
      time: 0, //计时器
      qrCode: {
        url: "www.jiwenwang.com",
        icon:
          "https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=1825245023,2600743440&fm=26&gp=0.jpg",
      }, // 二维码
    };
  },
  methods: {
    // 关闭分享二维码
    openShare(){
      this.shareModal = true;
    },
    // 改变为文字样式
    toFonts(e, content) {
      e.target.innerHTML = content;
      if (content == "客服") {
        this.showPanel("side-service");
      } else if (content == "微信") {
        this.showPanel("side-wechat");
      }
    },
    // 改变为svg样式
    toSvg(e) {
      let icon = "";
      switch (e.target.innerHTML) {
        case "客服": {
          icon = this.svg1;
          this.hidePanel("side-service");

          break;
        }
        case "微信": {
          icon = this.svg2;
          this.hidePanel("side-wechat");
          break;
        }
        case "置顶": {
          icon = this.svg3;
          break;
        }
        case "推荐码": {
          icon = this.svg4;
          break;
        }
        case "分享": {
          icon = this.svg5;
        }
      }
      e.target.innerHTML = icon;
    },
    // 置顶
    toTop() {
      // 顺滑过渡
      let top = document.documentElement.scrollTop || document.body.scrollTop;
      let speed = Math.floor(top / 20);
      // 实现滚动效果
      const timer = setInterval(() => {
        speed = Math.floor(top / 20);
        document.body.scrollTop = document.documentElement.scrollTop = top -= speed;
        if (speed <= 0) {
          clearInterval(timer);
        }
      }, 10);
    },
    // 显示客服面板
    showPanel(obj) {
      let div = document.getElementsByClassName(obj);
      div[0].style.transform = "translateX(0px)";
    },
    // 隐藏面板
    hidePanel(obj) {
      let div = document.getElementsByClassName(obj);
      div[0].style.transform = "translateX(-150px)";
    },
    // 显示客服聊天框
    displayService() {},
    //获取推荐码
    getCode() {
      //获取缓存中的用户信息
      const userInfo = JSON.parse(window.sessionStorage.getItem("userInfo"));
      if (!userInfo) {
        return this.$Message.info("请先登录");
      }
      let data = new FormData();
      data.append("telephone", userInfo.phone);
      const loadingmsg = this.$Message.loading({
        content: "Loading...",
        duration: 0,
      });
      this.$http
        .post(this.domain + "visitor/getCode", data)
        .then((res) => {
          console.log(res);
          const { code, msg, data } = res.data;
          if (code == 1) {
            this.$Message.success("获取推荐码成功");
            this.recommendCode = data;
            //禁用按钮，防止用户恶意发送
            this.isBan = true;
            this.time = 60; //倒计时60s
            const timer = setInterval(() => {
              //计时结束，允许再次获取推荐码
              if (this.time-- <= 0) {
                clearInterval(timer); //清除计时器
                this.isBan = false; //解除禁用
              }
            }, 1000);
          } else {
            this.$Message.error("获取推荐码失败");
          }
        })
        .catch((err) => {
          console.log(err);
          this.$Message.error("服务器连接失败");
        })
        .finally(() => {
          setTimeout(loadingmsg, 0); //隐藏loading
        });
    },
    // 获取二维码
    copyShare(){
      let text = "集文网分享并收录多种期刊，提供论文分享、国际、国内优质期刊杂志投稿、论文查重等服务。详情请见：http://www.jiwenwang.com";
      let input = document.createElement('input');
      input.setAttribute('value',text);
      document.body.appendChild(input);
      input.select();
      input.setSelectionRange(0,9999);
      document.execCommand("copy");
      document.body.removeChild(input);
      this.$Message.success('复制成功');
    }
  },
  computed: {
    displayService: {
      get() {
        return this.$store.state.displayService;
      },
      set(val) {
        this.$store.commit("setService", val);
      },
    },
  },
};
</script>
<style lang="scss" scoped>
@import "./SideNav.scss";
</style>